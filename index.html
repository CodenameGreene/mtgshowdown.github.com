<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>MTG Showdown</title>
  <link rel="stylesheet" href="style.css"/>
  <link rel="icon" href="data:," />

  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

  <!-- Firebase Init -->
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCHqxtwOQkCYtuMJKtvB_EbuTUC05084Ts",
      authDomain: "mtgusers.firebaseapp.com",
      projectId: "mtgusers",
      storageBucket: "mtgusers.firebasestorage.app",
      messagingSenderId: "254815117873",
      appId: "1:254815117873:web:b31b12f841594e33feeb10",
      measurementId: "G-YWCWF0P3XR"
    };
    firebase.initializeApp(firebaseConfig);
    window.auth = firebase.auth();
    window.db = firebase.firestore();
  </script>
</head>
<body>
  <!-- Main Screen -->
  <div id="mainScreen">
    <h1>MTG Showdown</h1>

    <!-- Format dropdown -->
    <div class="dropdown">
      <button id="menuButton" class="small-button" onclick="toggleDropdown()">Select Format â–¾</button>
      <div id="formatDropdown" class="dropdown-content">
        <a href="#" onclick="changeMenuLabel('Standard')">Standard</a>
        <a href="#" onclick="changeMenuLabel('Modern')">Modern</a>
        <a href="#" onclick="changeMenuLabel('Commander')">Commander</a>
        <a href="#" onclick="changeMenuLabel('Booster Draft')">Booster Draft</a>
        <a href="#" onclick="changeMenuLabel('Pioneer')">Pioneer</a>
        <a href="#" onclick="changeMenuLabel('Pauper')">Pauper</a>
      </div>
    </div>

    <!-- Deck select -->
    <select id="mainDeckSelect" onchange="mainScreenDeckChanged()">
      <option value="">-- Select Deck --</option>
    </select>

    <!-- Buttons -->
    <div>
      <button class="small-button" onclick="showDeckBuilder()">Deck Builder</button>
      <button class="small-button" id="playButton" onclick="goToPlayScreen()" disabled>Play</button>
    </div>

    <!-- Login / Signup -->
    <div class="container">
      <h2>Login / Sign Up</h2>
      <input type="email" id="email" placeholder="Email" />
      <input type="password" id="password" placeholder="Password" />
      <button class="small-button" onclick="login()">Login</button>
      <button class="small-button" onclick="signup()">Sign Up</button>
      <p id="status"></p>
    </div>

    <!-- User Info -->
    <div id="userInfo"></div>
  </div>

  <!-- Deck Builder -->
  <div id="deckBuilder" style="display:none;">
    <h2>Deck Builder</h2>
    <input id="deckNameInput" type="text" placeholder="Deck Name"/>
    <select id="deckFormatSelect">
      <option value="">-- Select Format --</option>
      <option value="Standard">Standard</option>
      <option value="Modern">Modern</option>
      <option value="Commander">Commander</option>
      <option value="Booster Draft">Booster Draft</option>
      <option value="Pioneer">Pioneer</option>
      <option value="Pauper">Pauper</option>
    </select>
    <button class="small-button" onclick="saveDeck()">Save Deck</button>
    <button class="small-button" onclick="returnToMain()">Back</button>

    <h3>Search Cards</h3>
    <input id="cardSearchInput" type="text" placeholder="Search cards" oninput="searchCards()"/>
    <select id="cardTypeFilter" onchange="searchCards()">
      <option value="">All Types</option>
      <option value="creature">Creatures</option>
      <option value="artifact">Artifacts</option>
      <option value="land">Lands</option>
      <option value="instant">Instants</option>
      <option value="sorcery">Sorceries</option>
      <option value="enchantment">Enchantments</option>
      <option value="planeswalker">Planeswalkers</option>
    </select>

    <div id="cardSearchResults"></div>

    <h3>Your Deck</h3>
    <ul id="deckList"></ul>

    <h3>Saved Decks</h3>
    <select id="savedDecks" onchange="loadSelectedDeck()">
      <option value="">-- Select Deck --</option>
    </select>
  </div>

  <!-- Play Screen -->

  <!-- Play area styled using your CSS -->
  <div id="playScreen" style="display:none;">
  <h2>Game Mode: <span id="playFormat"></span></h2>
  <button class="small-button" onclick="returnToMain()">Return</button>
  <div id="gameInfo" style="margin:10px;">
    <span id="manaCount">Mana: 0</span> |
    <span id="turnCounter">Turn: 1</span>
  </div>


  <div id="playArea" class="panel">
    <h3>Your Hand</h3>
    <div id="hand" class="hand"></div>

    <h3>Battlefield</h3>
    <div id="battlefield" class="battlefield"></div>
    <button class="small-button" onclick="endTurn()">End Turn</button>
  </div>
  <!-- Hover Preview -->
<div id="hoverPreview" style="display:none; position:absolute; z-index:1000;">
    <img id="hoverPreviewImg" src="" alt="Card Preview" style="max-width:200px;">
</div>
  <!-- Dropdown Script -->
  <script>
    function toggleDropdown() {
      document.getElementById("formatDropdown").classList.toggle("show");
    }
    window.onclick = function(event) {
      if (!event.target.matches('#menuButton')) {
        const dropdown = document.getElementById("formatDropdown");
        if (dropdown.classList.contains("show")) dropdown.classList.remove("show");
      }
    }
  </script>

  <!-- Combined App Logic -->
  <script src="MTGShowdown.js" defer></script>
</body>
</html>
